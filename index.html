<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halƒ± Saha Kadrosu</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 15px; }
        .card { background: #1e1e1e; max-width: 450px; margin: auto; padding: 25px; border-radius: 20px; border: 1px solid #333; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .sayac { position: absolute; top: 15px; right: 15px; background: #2e7d32; padding: 6px 14px; border-radius: 50px; font-size: 13px; font-weight: bold; }
        input { padding: 12px; width: 85%; margin-bottom: 12px; border-radius: 10px; border: 1px solid #444; background: #252525; color: white; font-size: 16px; }
        .btns { display: flex; gap: 10px; margin-bottom: 20px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        .btn-g { background: #27ae60; } .btn-n { background: #c0392b; }
        .list-box { display: flex; justify-content: space-between; text-align: left; background: #252525; padding: 15px; border-radius: 12px; min-height: 150px; margin-bottom: 20px; }
        .col { width: 48%; }
        h4 { margin: 0 0 10px 0; font-size: 14px; border-bottom: 1px solid #444; padding-bottom: 5px; }
        .name { font-size: 14px; margin-bottom: 6px; color: #ddd; border-bottom: 1px solid #333; padding-bottom: 2px; }
        
        /* Rastgele Kaleci Alanƒ± */
        .kaleci-box { background: #2c3e50; padding: 15px; border-radius: 15px; border: 2px solid #f1c40f; margin-bottom: 15px; }
        .kaleci-text { font-size: 20px; color: #f1c40f; font-weight: bold; margin: 10px 0; min-height: 30px; }
        .btn-zar { background: #f1c40f; color: #000; width: 100%; margin-top: 10px; padding: 12px; border-radius: 10px; font-size: 14px; }

        /* Alt Bilgi Alanƒ± */
        .info-area { text-align: left; margin-top: 15px; border-top: 1px solid #333; padding-top: 10px; }
        .konum { color: #3498db; font-weight: bold; font-size: 15px; margin-bottom: 5px; }
        .gun { color: #f39c12; font-weight: bold; font-size: 15px; margin-bottom: 5px; }
        .signature { color: #ff0000; font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

<div class="card">
    <div class="sayac">KADRO: <span id="toplam">0</span></div>
    <h2>‚öΩ Halƒ± Saha Takip</h2>
    
    <input type="text" id="user-name" placeholder="Adƒ±nƒ±zƒ± yazƒ±n...">
    <div class="btns">
        <button class="btn-g" onclick="ekle(true)">GELƒ∞YORUM</button>
        <button class="btn-n" onclick="ekle(false)">YOKUM</button>
    </div>

    <div class="list-box">
        <div class="col">
            <h4 style="color: #2ecc71;">GELENLER</h4>
            <div id="gelenler"></div>
        </div>
        <div class="col">
            <h4 style="color: #e74c3c;">YOKLAR</h4>
            <div id="gitmeyenler"></div>
        </div>
    </div>

    <div class="kaleci-box">
        <h4 style="border:none; color:#f1c40f; margin:0;">üß§ RASTGELE KALECƒ∞</h4>
        <div id="mevcut-kaleci" class="kaleci-text">Hen√ºz Se√ßilmedi</div>
        <button class="btn-zar" onclick="kaleciSec()">üé≤ GELENLERDEN SE√á</button>
    </div>

    <div class="info-area">
        <div class="gun">G√ºnüìÖ: Salƒ±</div>
        <div class="konum">Konumüìç: Beylikbaƒüƒ± Stadƒ±</div>
        <div class="signature">By: Samet Ayvat</div>
    </div>
</div>

<script>
    const dbURL = "https://halisaha-47c07-default-rtdb.firebaseio.com/";
    let gelenlerDizisi = [];

    async function yukle() {
        try {
            const res = await fetch(dbURL + ".json");
            const data = await res.json();
            const gList = document.getElementById('gelenler');
            const nList = document.getElementById('gitmeyenler');
            const kText = document.getElementById('mevcut-kaleci');
            const sayac = document.getElementById('toplam');
            gList.innerHTML = ""; nList.innerHTML = "";
            gelenlerDizisi = [];
            let count = 0;
            if(data) {
                if(data.liste) {
                    Object.values(data.liste).forEach(item => {
                        const div = `<div class="name">‚Ä¢ ${item.ad}</div>`;
                        if(item.durum) { 
                            gList.innerHTML += div; 
                            gelenlerDizisi.push(item.ad); 
                            count++; 
                        } else { nList.innerHTML += div; }
                    });
                }
                if(data.aktifKaleci) { kText.innerText = data.aktifKaleci.ad; }
            }
            sayac.innerText = count;
        } catch(e) { console.log("Hata:", e); }
    }

    async function ekle(durum) {
        const ad = document.getElementById('user-name').value;
        if(!ad) return alert("ƒ∞sim yaz kanka!");
        await fetch(`${dbURL}liste.json`, { method: 'POST', body: JSON.stringify({ ad, durum }) });
        document.getElementById('user-name').value = "";
        yukle();
    }

    async function kaleciSec() {
        if(gelenlerDizisi.length === 0) return alert("√ñnce gelenler listesine isim ekleyin!");
        const sansliKisi = gelenlerDizisi[Math.floor(Math.random() * gelenlerDizisi.length)];
        await fetch(`${dbURL}aktifKaleci.json`, { method: 'PUT', body: JSON.stringify({ ad: sansliKisi }) });
        alert("Sistem rastgele se√ßti: " + sansliKisi);
        yukle();
    }

    yukle();
    setInterval(yukle, 4000);
</script>

</body>
</html>
